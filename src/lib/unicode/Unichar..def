(*!m2pim*) (* Copyright (c) 2024 Modula-2 Software Foundation. *)

DEFINITION MODULE Unichar;

(* Portable UNICHAR Type *)


FROM Octet IMPORT OctetT;
FROM Unichar0 IMPORT UnicharBaseT;


(* Highest Code Point *)

CONST MaxCodePoint = 1114111;


(* UNICHAR Type *)

TYPE UNICHAR = UnicharBaseT [0 .. MaxCodePoint];


(* Maximum UTF8 Length *)

CONST MaxUTF8Length = 4; (* RFC 3629 *)


(* UTF8 Type *)

TYPE UTF8 = RECORD
  length : CARDINAL;
  octet : ARRAY [0 .. MaxUTF8Length-1] OF OctetT
END; (* UTF8 *)



(* ---------------------------------------------------------------------------
 * function fromUTF8( utf8 )
 * ---------------------------------------------------------------------------
 * Returns UNICHAR code point value from UTF8.
 * ------------------------------------------------------------------------ *)

PROCEDURE fromUTF8 ( VAR (* CONST *) utf8 : UTF8 ) : UNICHAR;


(* ---------------------------------------------------------------------------
 * procedure ToUTF8( cp, utf8 )
 * ---------------------------------------------------------------------------
 * Converts UNICHAR code point value to UTF8.
 * ------------------------------------------------------------------------ *)

PROCEDURE ToUTF8 ( cp : UNICHAR; VAR utf8 : UTF8 );


END Unichar.